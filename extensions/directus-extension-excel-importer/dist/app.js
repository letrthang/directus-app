import{useApi as e,useStores as t,defineModule as l}from"@directus/extensions-sdk";import{defineComponent as a,ref as o,onMounted as n,resolveComponent as r,openBlock as s,createBlock as i,withCtx as u,createTextVNode as c,createElementVNode as d,withModifiers as p,createVNode as m,toDisplayString as v,createElementBlock as f,Fragment as g,renderList as y,createCommentVNode as b}from"vue";const x={key:0};var h=a({__name:"module",setup(l){const a=e(),{useCollectionsStore:h}=t(),_=h(),I=o(""),S=o(null),E=o(!1),A=o({message:""}),C=o(!1),k=o([]);function T(e){console.log("Selected collection:",e)}function V(e){var t,l;const a=e.target;console.log("Selected file:",null==(t=a.files)?void 0:t[0]),S.value=(null==(l=a.files)?void 0:l[0])||null}async function q(){if(console.log("Submitting:",{collection:I.value,file:S.value}),!S.value||!I.value)return A.value={message:"Please select a collection and upload a file"},void console.error("Validation failed:",{collection:I.value,file:S.value});E.value=!0,A.value={message:""},C.value=!1;const e=new FormData;e.append("file",S.value),e.append("collection",I.value);try{const t=await a.post("/excel-importer-endpoint",e,{headers:{"Content-Type":"multipart/form-data"}});console.log("API Response:",t.data),C.value=!0}catch(e){e.response&&e.response.data?A.value={message:e.response.data.error||"Import failed",details:e.response.data.details||[]}:A.value={message:e.message||"Import failed"},console.error("API Error:",e)}finally{E.value=!1}}return n(()=>{console.log("Excel Importer module loaded"),k.value=_.collections.map(e=>({value:e.collection,text:e.name})),console.log("Available collections:",k.value)}),(e,t)=>{const l=r("v-select"),a=r("v-button"),o=r("v-notice"),n=r("private-view");return s(),i(n,{title:"Excel Importer"},{headline:u(()=>[...t[1]||(t[1]=[c("Upload and Import Excel to Collection - clean architecture",-1)])]),default:u(()=>[d("form",{onSubmit:p(q,["prevent"])},[m(l,{modelValue:I.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>I.value=e),T],label:"Select Collection",items:k.value,required:""},null,8,["modelValue","items"]),d("input",{type:"file",accept:".xlsx",onChange:V,required:""},null,32),m(a,{type:"submit",loading:E.value},{default:u(()=>[...t[2]||(t[2]=[c("Import",-1)])]),_:1},8,["loading"])],32),A.value.message?(s(),i(o,{key:0,type:"danger"},{default:u(()=>[c(v(A.value.message)+" ",1),A.value.details&&A.value.details.length>0?(s(),f("ul",x,[(s(!0),f(g,null,y(A.value.details,(e,t)=>(s(),f("li",{key:t},v(e),1))),128))])):b("v-if",!0)]),_:1})):b("v-if",!0),C.value?(s(),i(o,{key:1,type:"success"},{default:u(()=>[...t[3]||(t[3]=[c("Import successful!",-1)])]),_:1})):b("v-if",!0)]),_:1})}}}),_=[],I=[];!function(e,t){if(e&&"undefined"!=typeof document){var l,a=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,n="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var r=_.indexOf(n);-1===r&&(r=_.push(n)-1,I[r]={}),l=I[r]&&I[r][a]?I[r][a]:I[r][a]=s()}else l=s();65279===e.charCodeAt(0)&&(e=e.substring(1)),l.styleSheet?l.styleSheet.cssText+=e:l.appendChild(document.createTextNode(e))}function s(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),o=0;o<l.length;o++)e.setAttribute(l[o],t.attributes[l[o]]);var r="prepend"===a?"afterbegin":"beforeend";return n.insertAdjacentElement(r,e),e}}("\nul[data-v-ec1dea1e] {\r\n  margin-top: 0.5rem;\r\n  padding-left: 1.5rem;\n}\nli[data-v-ec1dea1e] {\r\n  margin-bottom: 0.25rem;\n}\r\n",{});const S=[],E=[],A=[],C=[l({id:"excel-importer",name:"Excel Importer",icon:"upload_file",routes:[{path:"",component:((e,t)=>{const l=e.__vccOpts||e;for(const[e,a]of t)l[e]=a;return l})(h,[["__scopeId","data-v-ec1dea1e"],["__file","module.vue"]])}]})],k=[],T=[],V=[];export{E as displays,S as interfaces,A as layouts,C as modules,V as operations,k as panels,T as themes};
